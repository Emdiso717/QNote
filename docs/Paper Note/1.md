# Comparative performance of exponential, implicit, and explicit integrators for stiff systems of ODEs

!!! info
    这篇文章主要在对于 指数积分器 隐式 显式积分器 在求解 stiff system 的 ODE 问题的性能进行比较。本文关注重点是 何为指数积分器。

## Stiff System
对于一个 ODE System 会存在许多相差很大的时间尺度。某些分量随时间t变化很快，某些变化很慢。但是为了保持求解的稳定性，往往使用显示求解时需要选择一些比较小的时间步长。

??? note "关于Jacobian特征值与时间的关系"
    通过测试方程 $y^{\prime}(t) = \lambda y(t)$ 能测试系统稳定性。其真实解为 $y(t) = e^{\lambda t}$ 如果 $\lambda < 0 $ 并且绝对值很小 ，此时衰减速度便很慢，反之很快。所以有时会使用比值来判断刚度
    $$
    S = \frac{max|Re(\lambda)|}{min|Re(\lambda)|}
    $$

刚性系统并没有一个定量的精确判据。往往使用显示方法时，数值稳定性强迫步长远小于解实际变化所需的步长，这时就说问题是刚性的。

## Exponential Integrators

首先，明确我们要求解的问题是一个非线性ODE的初始问题，通常表达为如下形式：

$$
\frac{dy}{dt} = F(y(t)),  y(t_0)=y_0 ,y  \in \R^N
$$

在这里F是一个非线性的函数，在某些文章或者介绍中也通常把F直接拆开成 线性部分 + 非线性部分的形式。 在这里使用 Taylor expansion 获得一个更加普遍的结果（展开也是提出线性部分）。

$$
\frac{dy(t+\Delta t)}{dt} = F(y(t)) + J(y(t))[y(t+\Delta t)-y(t)] + R(y(t+\Delta t)) \\\\
R(y(t+\Delta t)) = F(y(t+\Delta t)) - F(y(t)) -J(y(t+\Delta t)-y(t))
$$

对这个ODE进行求解，满足形式 $v^{\prime} = Av+P(v)$ :

$$
d(t+s)e^{-Js}{ds}=(y^{\prime}-Jy+R)e^{-JS} \\\\
y(t+\Delta t) =y(t) + (e^{\Delta tJ}-I)(J\Delta t)^{-1}\Delta t F(y(t)) + \int^1_0e^{J\Delta t(1-\theta)}R(y(t+\Delta t \theta))d \theta
$$

可以看出这个方法最重要的还是处理之后的非线性的积分部分 和 对于 $e^{J}$ 的计算。


这个积分部分的展开有多种方式，取点点方式也有许多，这个不是这篇文章重点的部分，就简单跳过。

不妨对于 指数内部内容再进行一次展开 $K(x) =e^{J\Delta t(1-x)}R(y(t+\Delta t x)) = k_1x+k_2x^2+........$,此时再次进行积分能得到如下结果：

$$
\phi_0(hJ)b_0+\phi_1(hJ)b_1+..........\phi_i(hJ)b_i \\\\
\phi_k(z) = \int_0^1 e^{z(1-\theta)}\frac{\theta^{k-1}}{(k-1)!}d\theta
$$

在对于其中的 自然对数 进行幂级数分解，则能容易得到 $\phi_i(hJ) = \sum_{k=0}^{\infin}\frac{{hJ}^k}{(i+k)!}$

无论是哪一种分解都需要对于这个积分函数进行计算 $\phi_i(hJ)$ 可以看出里面是存在 $Jh$ 的幂次的。通常使用 **Krylov Subspace** 优化相关的计算。

原函数 $\phi$ 可以看作在 空间 ${b,(hJ)b,(hJ)^2b.....}$ 空间中的线性组合，但是计算量过大，于是考虑将空间投影到 krylov subsapce $k_m(hJ,b) = span{b,.....(hJ)^{m-1}b}$ 

通过 Arnoldi Algroithm 能轻松构造出子空间的一组正交基 $V_m$ 投影因子是 $V_mV_T$ 将 $f(hJ)$ 投影到子空间 $V_m^Tf(hJ)V_m$ 将b再投影 $V_m^Tb$ 最后在转回基坐标，得到 $f(hJ) \approx V_mV_m^Tf(hJ)V_mV_m^Tb $ 。由于 b 本身就为一个基则 $V_m^Tb = \|b\|_2 e_1$.

于是最终结果为 $f(hJ)b \approx \|b\|_2V_mf(H_m)e_1$

以上部分便是指数积分器的基本介绍部分，之后的实验比较部分还没有仔细阅读。
